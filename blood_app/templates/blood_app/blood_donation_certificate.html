<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Blood Donation Certificate</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
      .certificate {
        max-width: 800px;
        margin: 40px auto;
        padding: 30px;
        border: 3px solid #dc3545;
        border-radius: 12px;
        background: #fff;
        box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      }
      .certificate h1 { 
        color: #dc3545; 
        text-align: center;
        margin-bottom: 30px;
      }
      .meta { color: #555; }
      .donation-details {
        background: #f8f9fa;
        padding: 20px;
        border-radius: 8px;
        margin: 20px 0;
      }
      .signature-section {
        margin-top: 40px;
        border-top: 2px solid #dc3545;
        padding-top: 20px;
      }
      @media print { 
        .no-print { display:none; } 
        .certificate { 
          border: 2px solid #000; 
          box-shadow: none;
        }
      }
    </style>
  </head>
  <body>
    <div class="certificate">
      <h1>üè• Blood Donation Certificate</h1>
      
      <div class="d-flex align-items-center gap-3 mb-4">
        {% if donation.donor.photo %}
          <img src="{{ donation.donor.photo.url }}" alt="{{ donation.donor.name }}" class="rounded" style="width:100px;height:120px;object-fit:cover;border:2px solid #dc3545;">
        {% else %}
          <div class="bg-light border rounded d-flex align-items-center justify-content-center" style="width:100px;height:120px;">
            <i class="bi bi-person text-muted" style="font-size: 2rem;"></i>
          </div>
        {% endif %}
        <div>
          <p class="mb-1 text-muted">This is to certify that</p>
          <h3 class="mb-1 text-danger"><strong>{{ donation.donor.name }}</strong></h3>
          <p class="meta mb-0">Age: {{ donation.donor.age }} | Gender: {{ donation.donor.gender }}</p>
          <p class="meta mb-0">Blood Group: <span class="badge bg-danger">{{ donation.donor.blood_group }}</span></p>
          <p class="meta mb-0">District: {{ donation.donor.district }} | City: {{ donation.donor.city }}</p>
        </div>
      </div>

      <div class="donation-details">
        <h5 class="text-danger mb-3">üìã Donation Details</h5>
        <div class="row">
          <div class="col-md-6">
            <p><strong>Donation Date:</strong> {{ donation.donation_date|date:"F d, Y" }}</p>
            <p><strong>Hospital:</strong> {{ donation.hospital_name }}</p>
          </div>
          <div class="col-md-6">
            <p><strong>Blood Group Donated:</strong> <span class="badge bg-danger">{{ donation.blood_group }}</span></p>
            <p><strong>Units Donated:</strong> {{ donation.units_donated }} unit(s)</p>
          </div>
        </div>
        {% if donation.notes %}
          <p><strong>Notes:</strong> {{ donation.notes }}</p>
        {% endif %}
      </div>

      <div class="mt-4">
        <p class="lead">üéâ <strong>{{ donation.donor.name }}</strong> has successfully donated blood and contributed to saving lives. This act of generosity demonstrates a commitment to helping others in need.</p>
        
        <div class="row mt-4">
          <div class="col-md-6">
            <p><strong>Total Donations:</strong> {{ donation.donor.get_donation_count }} time(s)</p>
          </div>
          <div class="col-md-6">
            <p><strong>Contact:</strong> {{ donation.donor.phone }}{% if donation.donor.email %} | {{ donation.donor.email }}{% endif %}</p>
          </div>
        </div>
      </div>

      <div class="signature-section">
        <div class="row">
          <div class="col-md-6">
            <p class="mb-1"><strong>Certificate Generated:</strong></p>
            <p class="text-muted">{{ donation.created_at|date:"F d, Y H:i" }}</p>
          </div>
          <div class="col-md-6 text-end">
            <p class="mb-1"><strong>Authorized Signatory</strong></p>
            <p class="text-muted">Blood Bank Authority</p>
          </div>
        </div>
      </div>

      <div class="no-print mt-4 text-center">
        <button class="btn btn-danger btn-lg me-2" onclick="window.print()">
          <i class="bi bi-printer me-2"></i>Print Certificate
        </button>
        <a href="{% url 'donor_list' %}" class="btn btn-outline-secondary btn-lg">
          <i class="bi bi-arrow-left me-2"></i>Back to Donors
        </a>
      </div>
    </div>
  </body>
  </html>
