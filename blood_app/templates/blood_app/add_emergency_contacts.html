{% extends 'blood_app/base.html' %}
{% block title %}Add Emergency Contacts - Blood Donation{% endblock %}
{% block content %}
<div class="row justify-content-center">
  <div class="col-lg-8">
    <div class="card shadow-sm">
      <div class="card-header bg-warning text-dark">
        <h3 class="mb-0"><i class="bi bi-telephone-fill me-2"></i>Add Emergency Contacts</h3>
      </div>
      <div class="card-body">
        <div class="alert alert-info">
          <i class="bi bi-info-circle me-2"></i>
          <strong>{{ user.name }}</strong>, please add emergency contacts who can be reached in case of urgent blood donation requests.
        </div>
        
        <form method="post" class="fade-in">
          {% csrf_token %}
          
          <div class="row g-3">
            <div class="col-md-6">
              <label for="{{ form.name.id_for_label }}" class="form-label">Contact Name</label>
              {{ form.name }}
              {% if form.name.errors %}
                <div class="text-danger small">{{ form.name.errors.0 }}</div>
              {% endif %}
            </div>
            
            <div class="col-md-6">
              <label for="{{ form.relationship.id_for_label }}" class="form-label">Relationship</label>
              {{ form.relationship }}
              {% if form.relationship.errors %}
                <div class="text-danger small">{{ form.relationship.errors.0 }}</div>
              {% endif %}
            </div>
            
            <div class="col-md-6">
              <label for="{{ form.phone.id_for_label }}" class="form-label">Phone Number</label>
              {{ form.phone }}
              {% if form.phone.errors %}
                <div class="text-danger small">{{ form.phone.errors.0 }}</div>
              {% endif %}
            </div>
            
            <div class="col-md-6">
              <label for="{{ form.email.id_for_label }}" class="form-label">Email (Optional)</label>
              {{ form.email }}
              {% if form.email.errors %}
                <div class="text-danger small">{{ form.email.errors.0 }}</div>
              {% endif %}
            </div>
          </div>
          
          <div class="d-flex gap-2 mt-4">
            <button type="submit" class="btn btn-warning">
              <i class="bi bi-plus-circle me-2"></i>Add Contact
            </button>
            <a href="{% url 'user_profile' user.id %}" class="btn btn-outline-secondary">
              <i class="bi bi-arrow-left me-2"></i>Skip for Now
            </a>
          </div>
        </form>
        
        {% if existing_contacts %}
        <hr class="my-4">
        <h5><i class="bi bi-list-check me-2"></i>Existing Emergency Contacts</h5>
        <div class="table-responsive">
          <table class="table table-sm">
            <thead>
              <tr>
                <th>Name</th>
                <th>Relationship</th>
                <th>Phone</th>
                <th>Email</th>
              </tr>
            </thead>
            <tbody>
              {% for contact in existing_contacts %}
              <tr>
                <td>{{ contact.name }}</td>
                <td>{{ contact.relationship }}</td>
                <td>{{ contact.phone }}</td>
                <td>{{ contact.email|default:"-" }}</td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
        {% endif %}
      </div>
    </div>
  </div>
</div>
{% endblock %}
